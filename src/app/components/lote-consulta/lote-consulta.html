<div class="consulta-container">
  <div class="header-container">
    <h2>Painel de Lotes de Porcas</h2>

    @if(authService.isAdmin()){
    <a
      mat-raised-button
      color="primary"
      routerLink="/dashboard/admin/lotes/novo"
    >
      <mat-icon>add</mat-icon>
      Cadastrar Novo Lote
    </a>
    }
  </div>

  <mat-form-field appearance="outline" class="search-field">
    <mat-label>Buscar por Código do Lote</mat-label>
    <input
      matInput
      [formControl]="searchControl"
      placeholder="Digite para buscar..."
    />
    <mat-icon matSuffix>search</mat-icon>
  </mat-form-field>

  <div class="table-container mat-elevation-z8">
    @if(isLoading) {
    <div class="spinner-container">
      <mat-spinner></mat-spinner>
    </div>
    } @else { @if(error) {
    <p class="error-message">{{ error }}</p>
    } @else {
    <table mat-table [dataSource]="lotes">
      <ng-container matColumnDef="codigo_lote">
        <th mat-header-cell *matHeaderCellDef>Código do Lote</th>
        <td mat-cell *matCellDef="let lote">{{ lote.codigo_lote }}</td>
      </ng-container>

      <ng-container matColumnDef="data_criacao">
        <th mat-header-cell *matHeaderCellDef>Data de Criação</th>
        <td mat-cell *matCellDef="let lote">
          {{ lote.data_criacao_display || "" }}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="colunasExibidas"></tr>
      <tr mat-row *matRowDef="let row; columns: colunasExibidas"></tr>
    </table>

    @if (lotes.length === 0 && !isLoading) {
    <p class="empty-message">Nenhum lote encontrado</p>
    } } }
  </div>
</div>
